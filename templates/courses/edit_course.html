{% extends 'base.html' %}
{% load static %}

{% block title %}Edit Course - Dojo{% endblock %}

{% block content %}
<!-- Flash Messages -->
{% include 'components/messages.html' %}

<div class="container-fluid py-4">
    <div class="row justify-content-center">
        <div class="col-md-8 col-lg-6">
            <div class="card" style="border: 2px solid #000000; background-color: #FBF3D5;">
                <div class="card-header text-center" style="background-color: #FBF3D5; border-bottom: 2px solid #000000;">
                    <h3 class="mb-0" style="color: #000000; font-weight: bold;">Edit Course</h3>
                </div>
                <div class="card-body">
                    <form method="post" enctype="multipart/form-data">
                        {% csrf_token %}
                        
                        <!-- Course Name -->
                        <div class="mb-4">
                            <label for="id_name" class="form-label fw-bold" style="color: #000000;">Course Name</label>
                            <input type="text" class="form-control" id="id_name" name="name" value="{{ course.name }}" required style="border: 2px solid #000000; background-color: #FFFFFF;">
                        </div>

                        <!-- Instructor (Optional) -->
                        <div class="mb-4">
                            <label for="id_instructor" class="form-label fw-bold" style="color: #000000;">Instructor (Optional)</label>
                            <input type="text" class="form-control" id="id_instructor" name="instructor" value="{{ course.instructor|default:'' }}" style="border: 2px solid #000000; background-color: #FFFFFF;">
                        </div>

                        <!-- Room Location (Optional) -->
                        <div class="mb-4">
                            <label for="id_room_location" class="form-label fw-bold" style="color: #000000;">Room Location (Optional)</label>
                            <input type="text" class="form-control" id="id_room_location" name="room_location" value="{{ course.room_location|default:'' }}" style="border: 2px solid #000000; background-color: #FFFFFF;">
                        </div>

                        <!-- Course Color -->
                        <div class="mb-4">
                            <label class="form-label fw-bold" style="color: #000000;">Course Color</label>
                            <div class="color-picker">
                                <div class="color-options">
                                    <input type="radio" id="color-ffe0ef" name="color" value="#ffe0ef" {% if course.color == '#ffe0ef' %}checked{% endif %} style="display: none;">
                                    <label for="color-ffe0ef" class="color-option" style="background-color: #ffe0ef; border: 2px solid #000000;"></label>
                                    
                                    <input type="radio" id="color-BFECFF" name="color" value="#BFECFF" {% if course.color == '#BFECFF' %}checked{% endif %} style="display: none;">
                                    <label for="color-BFECFF" class="color-option" style="background-color: #BFECFF; border: 2px solid #000000;"></label>
                                    
                                    <input type="radio" id="color-B7B1F2" name="color" value="#B7B1F2" {% if course.color == '#B7B1F2' %}checked{% endif %} style="display: none;">
                                    <label for="color-B7B1F2" class="color-option" style="background-color: #B7B1F2; border: 2px solid #000000;"></label>
                                    
                                    <input type="radio" id="color-c1cfa1" name="color" value="#c1cfa1" {% if course.color == '#c1cfa1' %}checked{% endif %} style="display: none;">
                                    <label for="color-c1cfa1" class="color-option" style="background-color: #c1cfa1; border: 2px solid #000000;"></label>
                                    
                                    <input type="radio" id="color-f0a04b" name="color" value="#f0a04b" {% if course.color == '#f0a04b' %}checked{% endif %} style="display: none;">
                                    <label for="color-f0a04b" class="color-option" style="background-color: #f0a04b; border: 2px solid #000000;"></label>
                                </div>
                            </div>
                        </div>

                        <!-- Current Course Image Preview -->
                        {% if course.image %}
                        <div class="mb-4">
                            <label class="form-label fw-bold" style="color: #000000;">Current Course Image</label>
                            <div class="text-center">
                                <img src="{{ course.image.url }}" alt="Current course image" style="width: 150px; height: 150px; object-fit: cover; border-radius: 10px; border: 2px solid #000000;">
                            </div>
                        </div>
                        {% endif %}

                        <!-- New Course Image -->
                        <div class="mb-4">
                            <label for="id_image" class="form-label fw-bold" style="color: #000000;">New Course Image (Optional)</label>
                            <input type="file" class="form-control" id="id_image" name="image" accept="image/*" style="border: 2px solid #000000; background-color: #FFFFFF;">
                            <small class="text-muted">Leave empty to keep the current image</small>
                        </div>

                        <!-- Buttons -->
                        <div class="d-flex justify-content-between">
                            <a href="{% url 'courses:course_list' %}" class="btn btn-outline-dark" style="border: 2px solid #000000; background-color: #FBF3D5;">
                                <i class="bi bi-arrow-left"></i> Cancel
                            </a>
                            <button type="submit" class="btn btn-outline-dark" style="border: 2px solid #000000; background-color: #FBF3D5;">
                                <i class="bi bi-check-circle"></i> Save Changes
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
.color-picker {
    margin-top: 10px;
}

.color-options {
    display: flex;
    gap: 15px;
    justify-content: center;
}

.color-option {
    width: 40px;
    height: 40px;
    border-radius: 50%;
    cursor: pointer;
    transition: transform 0.2s ease;
    position: relative;
}

.color-option:hover {
    transform: scale(1.1);
}

.color-option:has(input:checked) {
    transform: scale(1.2);
    box-shadow: 0 0 0 3px #000000;
}

.color-option:has(input:checked)::after {
    content: 'âœ“';
    position: absolute;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    color: #000000;
    font-weight: bold;
    font-size: 16px;
}
</style>

<script>
document.addEventListener('DOMContentLoaded', function() {
    // Color picker functionality
    const colorOptions = document.querySelectorAll('.color-option');
    colorOptions.forEach(option => {
        option.addEventListener('click', function() {
            // Remove checked from all options
            colorOptions.forEach(opt => opt.classList.remove('selected'));
            // Add checked to clicked option
            this.classList.add('selected');
            // Check the radio button
            this.querySelector('input').checked = true;
        });
    });

    // Initialize selected color
    const checkedColor = document.querySelector('input[name="color"]:checked');
    if (checkedColor) {
        checkedColor.closest('.color-option').classList.add('selected');
    }
});
</script>
{% endblock %}
